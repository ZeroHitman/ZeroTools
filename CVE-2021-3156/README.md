# CVE-2021-3156 (Sudo Baron Samedit)
[![Python3.x](https://img.shields.io/badge/python-3.x-FADA5E.svg?logo=python)](https://www.python.org/) [![PEP8](https://img.shields.io/badge/code%20style-pep8-red.svg)](https://www.python.org/dev/peps/pep-0008/)

This repository is CVE-2021-3156 exploit targeting Linux x64. For writeup, please visit https://datafarm-cybersecurity.medium.com/exploit-writeup-for-cve-2021-3156-sudo-baron-samedit-7a9a4282cb31  
Credit to [Braon Samedit of Qualys for the original advisory](https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt).

---

### Files
##### Exploit on glibc without tcache
 * **exploit_cent7_userspec_py2.py**
PoC variant implemented for Python 2. Tailored for CentOS 7 with default configuration.

* **exploit_cent7_userspec_py3.py**
PoC variant implemented for Python 3. Functionally equivalent to the Python 2 variant but adapted for Python 3 bytes / str differences and runtime behavior.

---
### How to check if you are affected.

[The sudo project](https://www.sudo.ws/alerts/unescape_overflow.html) released a command that allows you to test whether your version of sudo is vulnerable:
```
sudoedit -s '\' `perl -e 'print "A" x 65536'`
```
If you receive a usage or error message, sudo is not vulnerable. If the result is a Segmentation fault, sudo is vulnerable.
